<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEON OVERDRIVE: ULTIMATE</title>
    <style>
        body { margin: 0; background: #000; color: #00f2ff; font-family: 'Courier New', monospace; overflow: hidden; display: flex; justify-content: center; align-items: center; height: 100vh; }
        canvas { border: 2px solid #00f2ff; cursor: crosshair; }
        #ui { position: absolute; top: 20px; left: 20px; pointer-events: none; z-index: 5; }
        #gameOver { position: absolute; display: none; text-align: center; background: rgba(0,0,0,0.9); padding: 40px; border: 2px solid #ff0055; z-index: 10; }
        .crt::after { content: " "; display: block; position: absolute; top: 0; left: 0; bottom: 0; right: 0; background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06)); z-index: 2; background-size: 100% 2px, 3px 100%; pointer-events: none; }
        button { background: transparent; border: 2px solid #00f2ff; color: #00f2ff; padding: 10px 20px; cursor: pointer; font-weight: bold; margin-top: 20px; }
        #startBtn { position: absolute; z-index: 100; padding: 20px 40px; font-size: 20px; background: #000; color: #00f2ff; border: 4px solid #00f2ff; cursor: pointer; box-shadow: 0 0 20px #00f2ff; }
    </style>
</head>
<body class="crt">

    <button id="startBtn" onclick="startGame()">INITIATE SYSTEM</button>

    <div id="ui">
        <div style="font-size: 30px; font-weight: 900;">DATA: <span id="score">0</span></div>
        <div id="dashStatus">DASH READY</div>
    </div>

    <div id="gameOver">
        <h1 style="color: #ff0055; font-size: 3rem;">SYSTEM CRITICAL</h1>
        <button onclick="location.reload()">RELOAD</button>
    </div>

    <canvas id="c"></canvas>

    <script>
        const canvas = document.getElementById('c');
        const ctx = canvas.getContext('2d');
        const scoreEl = document.getElementById('score');
        const dashEl = document.getElementById('dashStatus');
        
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let score = 0, gameActive = false, shake = 0, dashCooldown = 0, isDashing = 0;
        let audioCtx, oscillator, gainNode;

        const player = { x: canvas.width/2, y: canvas.height/2, size: 20, targetX: canvas.width/2, targetY: canvas.height/2 };
        const enemies = [], particles = [], food = [];

        // --- AUDIO ENGINE ---
        function initAudio() {
            audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            // Start a simple looping bassline
            setInterval(() => {
                if(!gameActive) return;
                playTone(110 + (score * 2), 'sawtooth', 0.1, 0.05);
            }, 500);
        }

        function playTone(freq, type, duration, volume) {
            if(!audioCtx) return;
            const osc = audioCtx.createOscillator();
            const g = audioCtx.createGain();
            osc.type = type;
            osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
            g.gain.setValueAtTime(volume, audioCtx.currentTime);
            g.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + duration);
            osc.connect(g);
            g.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + duration);
        }

        function startGame() {
            document.getElementById('startBtn').style.display = 'none';
            gameActive = true;
            initAudio();
            spawnEnemy();
            spawnFood();
            draw();
        }

        window.addEventListener('mousemove', e => {
            player.targetX = e.clientX;
            player.targetY = e.clientY;
        });

        const triggerDash = () => {
            if (dashCooldown <= 0 && gameActive) {
                isDashing = 10;
                dashCooldown = 50;
                playTone(440, 'square', 0.2, 0.1);
            }
        };
        window.addEventListener('keydown', e => { if(e.code === 'Space') triggerDash(); });
        window.addEventListener('mousedown', triggerDash);

        function update() {
            if (!gameActive) return;

            // Move & Clamp Player
            const dx = player.targetX - player.x;
            const dy = player.targetY - player.y;
            const speed = isDashing > 0 ? 0.4 : 0.15;
            
            player.x += dx * speed;
            player.y += dy * speed;

            // Prevent disappearing
            player.x = Math.max(10, Math.min(canvas.width - 10, player.x));
            player.y = Math.max(10, Math.min(canvas.height - 10, player.y));

            if (isDashing > 0) isDashing--;
            if (dashCooldown > 0) {
                dashCooldown--;
                dashEl.style.opacity = 0.3;
            } else {
                dashEl.style.opacity = 1;
            }

            enemies.forEach((en, i) => {
                en.x += Math.cos(en.angle) * en.speed;
                en.y += Math.sin(en.angle) * en.speed;
                if (Math.hypot(en.x - player.x, en.y - player.y) < en.size/2 + 8 && isDashing <= 0) {
                    gameActive = false;
                    playTone(100, 'sawtooth', 0.5, 0.2);
                    document.getElementById('gameOver').style.display = 'block';
                }
            });

            food.forEach((f, i) => {
                if (Math.hypot(f.x - player.x, f.y - player.y) < 25) {
                    food.splice(i, 1);
                    score++;
                    scoreEl.innerText = score;
                    shake = 10;
                    playTone(880, 'sine', 0.1, 0.1);
                    spawnFood();
                }
            });
            if (shake > 0) shake *= 0.9;
        }

        function spawnEnemy() {
            if (!gameActive) return;
            const side = Math.floor(Math.random() * 4);
            let x = side % 2 === 0 ? Math.random() * canvas.width : (side === 1 ? canvas.width + 20 : -20);
            let y = side % 2 !== 0 ? Math.random() * canvas.height : (side === 0 ? -20 : canvas.height + 20);
            enemies.push({ x, y, size: 20, speed: 3 + (score/5), angle: Math.atan2(player.y - y, player.x - x)});
            setTimeout(spawnEnemy, Math.max(200, 1000 - (score * 20)));
        }

        function spawnFood() {
            if (gameActive) food.push({ x: 100 + Math.random()*(canvas.width-200), y: 100 + Math.random()*(canvas.height-200) });
        }

        function draw() {
            if (!gameActive) return;
            ctx.fillStyle = 'rgba(0, 0, 0, 0.15)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            ctx.save();
            if (shake > 1) ctx.translate(Math.random()*shake, Math.random()*shake);

            // Food
            ctx.fillStyle = "#00f2ff";
            food.forEach(f => ctx.fillRect(f.x-5, f.y-5, 10, 10));

            // Enemies
            ctx.fillStyle = "#ff0055";
            enemies.forEach(en => ctx.fillRect(en.x-10, en.y-10, 20, 20));

            // Player
            ctx.shadowBlur = 15;
            ctx.shadowColor = isDashing > 0 ? "#fff" : "#00f2ff";
            ctx.fillStyle = isDashing > 0 ? "#fff" : "#00f2ff";
            ctx.fillRect(player.x-10, player.y-10, 20, 20);

            ctx.restore();
            requestAnimationFrame(draw);
            update();
        }
    </script>
</body>
</html>